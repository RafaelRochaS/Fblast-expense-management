trigger:
- develop

pool:
  vmImage: ubuntu-latest

variables:
  npm_config_cache: $(System.DefaultWorkingDirectory)/node_modules

jobs:
- job: Build_and_Test
  steps:
  - task: NodeTool@0
    inputs:
      versionSpec: '14.x'
    displayName: 'Install Node.js'

  - script: |
      npm install
    displayName: 'npm install'

  - task: Cache@2
    inputs:
      key: 'npm | "$(Agent.OS)" | package-lock.json'
      restoreKeys: |
        npm | "$(Agent.OS)"
      path: '$(npm_config_cache)'
      
  - script: |
      npm run test
    displayName: 'Test'

  - script: |
      npm run lint
    displayName: 'Lint'

  - script: |
      npm run audit
    displayName: 'Security Audit'